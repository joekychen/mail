<!DOCTYPE html>
<html><head><title>joekychen/mail » spec › mail › fields › bcc_field_spec.rb

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>bcc_field_spec.rb</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div><p>encoding: utf-8</p></td><td class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;spec_helper&#39;</span>

<span class="n">describe</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span> <span class="k">do</span>
  </pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>The "Bcc:" field (where the "Bcc" means "Blind Carbon Copy") contains
   addresses of recipients of the message whose addresses are not to be
   revealed to other recipients of the message.  There are three ways in
   which the "Bcc:" field is used.  In the first case, when a message
   containing a "Bcc:" field is prepared to be sent, the "Bcc:" line is
   removed even though all of the recipients (including those specified
   in the "Bcc:" field) are sent a copy of the message.  In the second
   case, recipients specified in the "To:" and "Cc:" lines each are sent
   a copy of the message with the "Bcc:" line removed as above, but the
   recipients on the "Bcc:" line get a separate copy of the message
   containing a "Bcc:" line.  (When there are multiple recipient
   addresses in the "Bcc:" field, some implementations actually send a
   separate copy of the message to each recipient with a "Bcc:"
   containing only the address of that particular recipient.) Finally,
   since a "Bcc:" field may contain no addresses, a "Bcc:" field can be
   sent without any addresses indicating to the recipients that blind
   copies were sent to someone.  Which method to use with "Bcc:" fields
   is implementation dependent, but refer to the "Security
   Considerations" section of this document for a discussion of each.</p></td><td class="code"><div class="highlight"><pre>  
  <span class="n">describe</span> <span class="s2">&quot;initialization&quot;</span> <span class="k">do</span>

    <span class="n">it</span> <span class="s2">&quot;should initialize&quot;</span> <span class="k">do</span>
      <span class="n">doing</span> <span class="p">{</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Bcc: Mikel&quot;</span><span class="p">)</span> <span class="p">}</span><span class="o">.</span><span class="n">should_not</span> <span class="n">raise_error</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s2">&quot;should mix in the CommonAddress module&quot;</span> <span class="k">do</span>
      <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">included_modules</span><span class="o">.</span><span class="n">should</span> <span class="kp">include</span><span class="p">(</span><span class="no">Mail</span><span class="o">::</span><span class="no">CommonAddress</span><span class="p">)</span> 
    <span class="k">end</span>

    <span class="n">it</span> <span class="s2">&quot;should accept a string with the field name&quot;</span> <span class="k">do</span>
      <span class="n">t</span> <span class="o">=</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;Bcc: Mikel Lindsaar &lt;mikel@test.lindsaar.net&gt;, &quot;Bob Smith&quot; &lt;bob@me.com&gt;&#39;</span><span class="p">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;Bcc&#39;</span>
      <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;Mikel Lindsaar &lt;mikel@test.lindsaar.net&gt;, &quot;Bob Smith&quot; &lt;bob@me.com&gt;&#39;</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s2">&quot;should accept a string without the field name&quot;</span> <span class="k">do</span>
      <span class="n">t</span> <span class="o">=</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;Mikel Lindsaar &lt;mikel@test.lindsaar.net&gt;, &quot;Bob Smith&quot; &lt;bob@me.com&gt;&#39;</span><span class="p">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;Bcc&#39;</span>
      <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;Mikel Lindsaar &lt;mikel@test.lindsaar.net&gt;, &quot;Bob Smith&quot; &lt;bob@me.com&gt;&#39;</span>
    <span class="k">end</span>

  <span class="k">end</span>
  </pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>Actual testing of CommonAddress methods occurs in the address field spec file</p></td><td class="code"><div class="highlight"><pre>  <span class="n">describe</span> <span class="s2">&quot;instance methods&quot;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">&quot;should return an address&quot;</span> <span class="k">do</span>
      <span class="n">t</span> <span class="o">=</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;Mikel Lindsaar &lt;mikel@test.lindsaar.net&gt;&#39;</span><span class="p">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">formatted</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="o">[</span><span class="s1">&#39;Mikel Lindsaar &lt;mikel@test.lindsaar.net&gt;&#39;</span><span class="o">]</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s2">&quot;should return two addresses&quot;</span> <span class="k">do</span>
      <span class="n">t</span> <span class="o">=</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;Mikel Lindsaar &lt;mikel@test.lindsaar.net&gt;, Ada Lindsaar &lt;ada@test.lindsaar.net&gt;&#39;</span><span class="p">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">formatted</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;Mikel Lindsaar &lt;mikel@test.lindsaar.net&gt;&#39;</span>
      <span class="n">t</span><span class="o">.</span><span class="n">addresses</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;ada@test.lindsaar.net&#39;</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s2">&quot;should return one address and a group&quot;</span> <span class="k">do</span>
      <span class="n">t</span> <span class="o">=</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;sam@me.com, my_group: mikel@me.com, bob@you.com;&#39;</span><span class="p">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">addresses</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;sam@me.com&#39;</span>
      <span class="n">t</span><span class="o">.</span><span class="n">addresses</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;mikel@me.com&#39;</span>
      <span class="n">t</span><span class="o">.</span><span class="n">addresses</span><span class="o">[</span><span class="mi">2</span><span class="o">].</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;bob@you.com&#39;</span>
    <span class="k">end</span>
    
    <span class="n">it</span> <span class="s2">&quot;should return the formatted line on to_s&quot;</span> <span class="k">do</span>
      <span class="n">t</span> <span class="o">=</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;sam@me.com, my_group: mikel@me.com, bob@you.com;&#39;</span><span class="p">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s1">&#39;sam@me.com, my_group: mikel@me.com, bob@you.com;&#39;</span>
    <span class="k">end</span>
    
    <span class="n">it</span> <span class="s2">&quot;should return nothing on encoded as Bcc should not be in the mail&quot;</span> <span class="k">do</span>
      <span class="n">t</span> <span class="o">=</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;sam@me.com, my_group: mikel@me.com, bob@you.com;&#39;</span><span class="p">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">encoded</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s2">&quot;&quot;</span>
    <span class="k">end</span>
    
    <span class="n">it</span> <span class="s2">&quot;should return the decoded line&quot;</span> <span class="k">do</span>
      <span class="n">t</span> <span class="o">=</span> <span class="no">Mail</span><span class="o">::</span><span class="no">BccField</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;sam@me.com, my_group: mikel@me.com, bob@you.com;&#39;</span><span class="p">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">decoded</span><span class="o">.</span><span class="n">should</span> <span class="n">eq</span> <span class="s2">&quot;sam@me.com, my_group: mikel@me.com, bob@you.com;&quot;</span>
    <span class="k">end</span>
    
  <span class="k">end</span>
  
  
<span class="k">end</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/mail",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
